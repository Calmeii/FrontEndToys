!function(e){function t(i){if(o[i])return o[i].exports;var n=o[i]={exports:{},id:i,loaded:!1};return e[i].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var o={};return t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){e.exports=o(2)},function(e,t){"use strict";function o(e){var t=e.topicContent.wordAudioURL.replace(/^\/?resources\//,e.resourcesPath);return t=t.replace(/_dat/g,""),t=t.replace(/.dat/g,".mp3")}Object.defineProperty(t,"__esModule",{value:!0}),t.getAudioPath=o},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),r=o(3),s=o(1);o(7);var a=function(){function e(t,o){i(this,e),this.rightNum=0,this.usedTime=0,this.process=!1,this.falling=!1,this.refs=t,this.liveHeight=0,this.wordObjects=o,this.topics=[],this.curTopic=null,this.curAudioEle=null,this.timerId=null,this.downTimerId=null,this.downSpeed=200,this.startTime=0,this.endTime=0,this.initEvent(),this.initTopics()}return n(e,[{key:"initTopics",value:function(){for(var e=this.wordObjects.length,t=0;e>t;++t){var o=this.wordObjects[t];if(""===o.topicContent.optionMean1){var i=(0,r.genRandomOption)(this.wordObjects,t,2);i&&(o.topicContent.optionMean1=this.wordObjects[i[0]].topicContent.wordMean,o.topicContent.optionMean2=this.wordObjects[i[1]].topicContent.wordMean)}}}},{key:"initEvent",value:function(){var e=this;this.refs.welcome.addEventListener("click",function(){e.process||e.start()},!1),this.refs.replayBtn.addEventListener("click",function(){e.replay()},!1),this.refs.pauseBtn.addEventListener("click",function(t){e.refs.welcome.classList.contains("hide")&&(e.togglePauseBtn(),e.process?e.pause():e.resume(),t.stopPropagation())},!1),this.refs.optionsTable.addEventListener("click",function(t){t.target.classList.contains("option")&&e.falling&&e.process&&e.checkAnswer(t.target),t.stopPropagation()},!1),this.refs.downWord.addEventListener("click",function(t){e.playWordAudio()},!1)}},{key:"initStatusBar",value:function(){this.rightNum=this.usedTime=0,this.refs.rightNumBar.textContent=this.rightNum,this.refs.usedTimeBar.textContent=this.usedTime}},{key:"initView",value:function(){this.liveHeight=document.body.clientHeight-120,this.refs.welcome.style.height=this.liveHeight+"px",this.refs.gameBox.style.height=this.liveHeight+"px",this.refs.wrongBlock.style.height=0,this.refs.welcome.classList.remove("hide"),this.refs.gameBox.classList.add("hide"),this.refs.playGround.classList.remove("hide"),this.refs.endReport.classList.add("hide")}},{key:"fetchWords",value:function(){var e=arguments.length<=0||void 0===arguments[0]?20:arguments[0];this.wordObjects.length<=0&&this.stop(),this.topics.length>0&&(this.wordObjects=this.wordObjects.concat(this.topics),this.topics=[]);for(var t=0;e>t&&this.wordObjects.length>0;++t)this.topics.push(this.wordObjects.shift());(0,r.randomSort)(this.topics)}},{key:"initOptionsTable",value:function(){for(var e=this.refs.optionBoxes.length,t=0;e>t;++t)this.refs.optionBoxes[t].classList.remove("right"),this.refs.optionBoxes[t].classList.remove("wrong"),this.refs.optionBoxes[t].textContent="";this.refs.meanBox.textContent=""}},{key:"increaseTime",value:function(){this.usedTime+=1,this.refs.usedTimeBar.textContent=this.usedTime}},{key:"increaseRightNum",value:function(){this.rightNum+=1,this.refs.rightNumBar.textContent=this.rightNum}},{key:"makeWordDown",value:function(e){var t=parseInt(e.style.top.replace("px",""));t+30>=this.liveHeight?this.checkAnswer(this.refs.optionBoxes[1]):(t+=5,e.style.top=t+"px")}},{key:"togglePauseBtn",value:function(){this.refs.pauseBtn.classList.contains("pause")?(this.refs.pauseBtn.classList.remove("pause"),this.refs.pauseBtn.classList.add("show")):(this.refs.pauseBtn.classList.remove("show"),this.refs.pauseBtn.classList.add("pause"))}},{key:"prepare",value:function(){this.initStatusBar(),this.initView(),this.initOptionsTable(),this.fetchWords(100)}},{key:"start",value:function(){var e=this;console.log("game start"),this.process=!0,this.refs.welcome.classList.add("hide"),this.refs.gameBox.classList.remove("hide"),this.startTime=Date.now(),this.timerId=setInterval(function(){e.increaseTime()},1e3),this.showWordTopic()}},{key:"replay",value:function(){console.log("game replay"),this.prepare()}},{key:"stop",value:function(){console.log("game stop"),this.process=!1,this.endTime=Date.now(),clearInterval(this.timerId),this.falling&&clearInterval(this.downTimerId);var e=(this.endTime-this.startTime)/1e3;this.refs.reportData[0].textContent=this.rightNum,this.refs.reportData[1].textContent=parseFloat(e).toFixed(2),this.refs.playGround.classList.add("hide"),this.refs.endReport.classList.remove("hide")}},{key:"pause",value:function(){this.process=!1,clearInterval(this.timerId),this.falling&&clearInterval(this.downTimerId)}},{key:"resume",value:function(){var e=this;this.process=!0,this.timerId=setInterval(function(){e.increaseTime()},1e3),this.falling?this.downTimerId=setInterval(function(){e.makeWordDown(e.refs.downWord)},this.downSpeed):this.showWordTopic()}},{key:"showWordTopic",value:function(){var e=this;this.topics.length<=5&&this.fetchWords(),this.genWordAudio(),this.preLoadAudio(),this.curTopic=this.topics.shift(),this.refs.downWord.textContent=this.curTopic.topicContent.word,this.refs.downWord.style.top=0,this.refs.downWord.classList.remove("hide"),this.falling=!0,this.curAudioEle=document.getElementById("audio"+this.curTopic.topicId),this.playWordAudio(),this.showOptions(),this.downTimerId=setInterval(function(){e.makeWordDown(e.refs.downWord)},this.downSpeed)}},{key:"genWordAudio",value:function(){this.curAudioEle&&(this.curAudioEle.removeEventListener("canplaythrough",this.playWordAudio.bind(this)),this.curAudioEle.parentElement.removeChild(this.curAudioEle),this.curAudioEle=null);for(var e=0;5>e;++e){var t=this.topics[e].topicId,o=document.getElementById("audio"+t);if(null==o){var i=(0,s.getAudioPath)(this.topics[e]);o=document.createElement("audio"),o.id="audio"+t,o.src=i,document.body.appendChild(o)}}}},{key:"preLoadAudio",value:function(){var e=document.getElementsByTagName("audio");console.log();for(var t=function(t){e[t].hasAttribute("loaded")||(e[t].load(),e[t].oncanplaythrough=function(o){e[t].setAttribute("loaded","true")})},o=0;o<e.length;++o)t(o)}},{key:"showOptions",value:function(){var e=[];e.push(this.curTopic.topicContent.wordMean),e.push(this.curTopic.topicContent.optionMean1),e.push(this.curTopic.topicContent.optionMean2),(0,r.randomSort)(e);for(var t=this.refs.optionBoxes.length,o=0;t>o;++o)this.refs.optionBoxes[o].classList.remove("right"),this.refs.optionBoxes[o].classList.remove("wrong"),this.refs.optionBoxes[o].textContent=e[o]}},{key:"playWordAudio",value:function(){this.curAudioEle.play()}},{key:"checkAnswer",value:function(e){this.falling&&clearInterval(this.downTimerId),this.falling=!1,this.refs.downWord.classList.add("hide");var t=this.curTopic.topicContent.word,o=this.curTopic.topicContent.wordMean;this.refs.meanBox.textContent=t+" = "+o;var i=e.textContent===o;i?this.whenAnswerRight(e):this.whenAnswerWrong(e),this.nextStep()}},{key:"whenAnswerRight",value:function(e){e.classList.add("right"),this.increaseRightNum(),this.downSpeed>100&&(this.downSpeed-=5)}},{key:"whenAnswerWrong",value:function(e){e.classList.add("wrong"),this.wordObjects.unshift(this.curTopic);var t=this.refs.wrongBlock.style.height;t=parseInt(t.replace("px",""))+40,this.refs.wrongBlock.style.height=t+"px",this.liveHeight-=40,this.liveHeight<=5&&this.stop()}},{key:"nextStep",value:function(){var e=this;this.process&&setTimeout(function(){e.showWordTopic()},500)}}]),e}();window.onload=function(){var e={playGround:document.getElementById("play-ground"),rightNumBar:document.getElementById("right-num"),usedTimeBar:document.getElementById("used-time"),pauseBtn:document.getElementById("pause-btn"),welcome:document.getElementById("welcome"),gameBox:document.getElementById("game-box"),wrongBlock:document.getElementById("wrong-block"),downWord:document.getElementById("down-word"),optionsTable:document.getElementById("options-table"),optionBoxes:document.querySelectorAll("#options-table > .option"),meanBox:document.getElementById("mean-box"),endReport:document.getElementById("end-report"),reportData:document.querySelectorAll(".report-data"),replayBtn:document.getElementById("replay-btn")},t=new a(e,window.cet4Word);t.prepare()}},function(e,t){"use strict";function o(e,t,o){var i=e.length;if(!(2>i-1)){for(var n=[];n.length<o;){var r=Math.floor(Math.random()*i);0>r||r>=i||r!==t&&n.indexOf(r)<0&&n.push(r)}return n}}function i(e){e.sort(function(e,t){return Math.random()>.5?1:-1})}Object.defineProperty(t,"__esModule",{value:!0}),t.genRandomOption=o,t.randomSort=i},function(e,t,o){t=e.exports=o(5)(),t.push([e.id,'body,html{height:100%;width:100%}body{margin:0;font-family:Helvetica Neue,Helvetica,STHeiTi,sans-serif;background-color:#f6f6f6;background-size:contain}*,body{box-sizing:border-box}*{-webkit-tap-highlight-color:transparent}.hide{display:none!important}.container{position:relative;min-height:100%}.container>#status-bar{height:2.5rem;border-bottom:.1rem solid #fa795d}.container>#status-bar>.status{display:inline-block;color:#959494;margin-left:2rem;padding:.2rem;font-size:.8rem;line-height:2.2rem;vertical-align:middle}.container>#status-bar>.status>#right-num,.container>#status-bar>.status>#used-time{color:#fa795d;font-size:1.2rem;vertical-align:top}.container>#status-bar>#pause-btn{position:absolute;right:.4rem;width:1.6rem;height:1.6rem;font-size:.8rem;line-height:1.25rem;display:inline-block;border:.1rem solid #fa795d;border-radius:1.6rem;color:#fa795d;margin:.4rem;text-align:center}.container>#status-bar>#pause-btn.pause>.logo{display:block}.container>#status-bar>#pause-btn.pause>.logo:before{content:"| |"}.container>#status-bar>#pause-btn.show>.logo{display:inline-block;width:0;height:0;vertical-align:middle;border-left:.8rem solid #fa795d;border-top:.5rem solid transparent;border-bottom:.5rem solid transparent;margin-left:.2rem}.container #welcome{position:relative;text-align:center;vertical-align:middle;color:#959494;font-size:1.25rem}.container #welcome p{position:absolute;display:block;top:40%;width:100%;margin:0}#game-box{text-align:center}#game-box #wrong-block{display:block;height:0;background:#e5e5e5}#game-box span{position:relative;width:33%;background:#fa795d;color:#f6f6f6;height:2.5rem;display:inline-block;line-height:2.5rem;z-index:999}.container #options-table{position:absolute;bottom:2.5rem;height:2.5rem;width:100%;border-top:.1rem solid #cdcdcc;border-bottom:.1rem solid #cdcdcc;text-align:center}.container #options-table .option{float:left;width:33.333%;height:100%;color:#514e4d;font-size:.9rem;line-height:2.5rem}.container #options-table .option.right{background-color:#fa795d;color:#fdfdfd}.container #options-table .option.wrong{background-color:#cdcdcc;color:#514e4d}.container #options-table .option:not(:last-child){border-right:.05rem solid #cdcdcc}.container #mean-box{position:absolute;bottom:0;height:2.5rem;width:100%;background-color:#fdfdfd;text-align:center;line-height:2.5rem;color:#959494;font-size:.9rem}#end-report{text-align:center;padding-top:5rem}#end-report .report{width:100%}#end-report .report .report-title{position:relative;display:inline-block;text-align:center;color:#fa795d;margin:0;font-size:.75rem}#end-report .report .report-title:after,#end-report .report .report-title:before{position:absolute;top:11px;width:4.5rem;height:1px;background-color:#ddd}#end-report .report .report-title:before{content:" ";right:100%}#end-report .report .report-title:after{left:100%;content:" "}#end-report .report .report-title span{padding:0 .8rem}#end-report .report .report-data{margin:.5rem;font-size:3.75rem;font-weight:100;color:#959494}#end-report .report-btn-group{margin-top:3rem}#end-report .report-btn-group .btn{border-radius:.25rem;height:2.5rem;width:6.75rem;border:1px solid #fa795d}#end-report .report-btn-group .btn:first-child{margin-right:1rem}#end-report .report-btn-group .btn-replay{color:#f6f6f6;background-color:#fa795d}#end-report .report-btn-group .btn-back{color:#fa795d;background-color:#f6f6f6}',""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var o=this[t];o[2]?e.push("@media "+o[2]+"{"+o[1]+"}"):e.push(o[1])}return e.join("")},e.i=function(t,o){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},n=0;n<this.length;n++){var r=this[n][0];"number"==typeof r&&(i[r]=!0)}for(n=0;n<t.length;n++){var s=t[n];"number"==typeof s[0]&&i[s[0]]||(o&&!s[2]?s[2]=o:o&&(s[2]="("+s[2]+") and ("+o+")"),e.push(s))}},e}},function(e,t,o){function i(e,t){for(var o=0;o<e.length;o++){var i=e[o],n=p[i.id];if(n){n.refs++;for(var r=0;r<n.parts.length;r++)n.parts[r](i.parts[r]);for(;r<i.parts.length;r++)n.parts.push(d(i.parts[r],t))}else{for(var s=[],r=0;r<i.parts.length;r++)s.push(d(i.parts[r],t));p[i.id]={id:i.id,refs:1,parts:s}}}}function n(e){for(var t=[],o={},i=0;i<e.length;i++){var n=e[i],r=n[0],s=n[1],a=n[2],c=n[3],d={css:s,media:a,sourceMap:c};o[r]?o[r].parts.push(d):t.push(o[r]={id:r,parts:[d]})}return t}function r(e,t){var o=g(),i=w[w.length-1];if("top"===e.insertAt)i?i.nextSibling?o.insertBefore(t,i.nextSibling):o.appendChild(t):o.insertBefore(t,o.firstChild),w.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");o.appendChild(t)}}function s(e){e.parentNode.removeChild(e);var t=w.indexOf(e);t>=0&&w.splice(t,1)}function a(e){var t=document.createElement("style");return t.type="text/css",r(e,t),t}function c(e){var t=document.createElement("link");return t.rel="stylesheet",r(e,t),t}function d(e,t){var o,i,n;if(t.singleton){var r=b++;o=v||(v=a(t)),i=l.bind(null,o,r,!1),n=l.bind(null,o,r,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(o=c(t),i=u.bind(null,o),n=function(){s(o),o.href&&URL.revokeObjectURL(o.href)}):(o=a(t),i=h.bind(null,o),n=function(){s(o)});return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else n()}}function l(e,t,o,i){var n=o?"":i.css;if(e.styleSheet)e.styleSheet.cssText=y(t,n);else{var r=document.createTextNode(n),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(r,s[t]):e.appendChild(r)}}function h(e,t){var o=t.css,i=t.media;if(i&&e.setAttribute("media",i),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}function u(e,t){var o=t.css,i=t.sourceMap;i&&(o+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var n=new Blob([o],{type:"text/css"}),r=e.href;e.href=URL.createObjectURL(n),r&&URL.revokeObjectURL(r)}var p={},f=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},m=f(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),g=f(function(){return document.head||document.getElementsByTagName("head")[0]}),v=null,b=0,w=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=m()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var o=n(e);return i(o,t),function(e){for(var r=[],s=0;s<o.length;s++){var a=o[s],c=p[a.id];c.refs--,r.push(c)}if(e){var d=n(e);i(d,t)}for(var s=0;s<r.length;s++){var c=r[s];if(0===c.refs){for(var l=0;l<c.parts.length;l++)c.parts[l]();delete p[c.id]}}}};var y=function(){var e=[];return function(t,o){return e[t]=o,e.filter(Boolean).join("\n")}}()},function(e,t,o){var i=o(4);"string"==typeof i&&(i=[[e.id,i,""]]);o(6)(i,{});i.locals&&(e.exports=i.locals)}]);